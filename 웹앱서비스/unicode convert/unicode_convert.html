<center>

<span style="font-size: 12pt; color: rgb(47, 157, 39);"><b>입력창</b></span><br>
  
<textarea rows="2" cols="120" id="contents" placeholder="이 곳에 텍스트를 입력하세요." autofocus="" required="" wrap="hard">테스트입니다.</textarea>

<table border="0">
<tbody><tr>
<td><input type="radio" name="chk_info" value="encode_mode" checked=""><b>텍스트를 유니코드로 변환</b></td>
<td><input type="radio" name="chk_info" value="decode_mode"><b>유니코드를 텍스트로 변환</b></td>
</tr></tbody></table> 

<br />

<table border="0">
<tbody>
<tr><td width="150px"><font color="blue"><b>유니코드(\\)</b></font></td>
<td><textarea rows="2" cols="95" id="result_content1" class="result_content_f" placeholder="" autofocus="" required="" wrap="hard"></textarea></td><td><input type="button" id="but1" value="복사"><br /></tr>
 
  <tr><td width="150px"><font color="blue"><b>유니코드(\)</font></td>
<td><textarea rows="2" cols="95" id="result_content2" class="result_content_f" placeholder="" autofocus="" required="" wrap="hard"></textarea></td><td><input type="button" id="but2" value="복사"><br /></tr>

  
</tbody>
</table>
</form>
</center>



<style>
textarea {
  box-sizing: border-box;
  border: 2px solid #ccc;
  border-radius: 4px;
  background-color: #f8f8f8;
  resize: none;
}

input[type=button], input[type=submit], input[type=reset] {
  background-color: #4CAF50;
  border: none;
  color: white;
  padding: 8px 16px;
  text-decoration: none;
  margin: 4px 2px;
  cursor: pointer;
}
</style>

<script>

$(document).ready(function(){
   execute();
  
  // 키 입력이 감지되면 코딩 함수 실행
    $("#contents").on('change keyup paste', function() 
    {
      execute();
      
    });
  
    $('input:radio[name="chk_info"]').on('click', function(e) {
     way = $(this).val();
     execute();
    });
  
  // copy
  $("input[type=button]:input[value='복사']").click(function(){ 

      var curen_id = $(this).attr('id');
      var textarea_id = [];

        curen_id = curen_id.replace("but","result_content");
        var copyText = $(`#${curen_id}`);
        copyText.select();
        document.execCommand("Copy");

  }); 

  
});



// 인코딩 / 디코딩 버튼 확인
var way = "encode_mode"; // default


function execute()
{
  var data = $("#contents").val();
  
  if ( ( $("#contents").val().startsWith( '\\\\u00' )) || $("#contents").val().startsWith( '\\u00' ) ) 
  { 
    way = "decode_mode";
    $('input:radio[name="chk_info"]')[1].checked = true;
  }
  else  { 
    way = "encode_mode";
    $('input:radio[name="chk_info"]')[0].checked = true;
  }
  
   if ( data ) 
   {
    if ( way == "encode_mode")
      {
        // $("#result_content1").val(efunc(data));
        $("#result_content1").val(ufunc(data));
        $("#result_content2").val(ufunc2(data));
   
       }
    else {
 var text = $('<textarea />').html( $("#contents").val() ).text();
  $("#result_content1").val( UnicodeTochar(text));
  $("#result_content2").val( UnicodeTochar2(text));
  
    } 
   } else { $(".result_content_f").val(""); }
  
}


ufunc = function(str) {
  if (!str) return false; 
  var unicode = '';
  for (var i = 0, l = str.length; i < l; i++) {
    if ( str[i].charCodeAt(0).toString(16) == 20 ) unicode += ' ';
    else unicode += '\\\\u00' + str[i].charCodeAt(0).toString(16);
  };
  return unicode;
}

ufunc2 = function(str) {
  if (!str) return false; 
  var unicode = '';
  for (var i = 0, l = str.length; i < l; i++) {
    if ( str[i].charCodeAt(0).toString(16) == 20 ) unicode += ' ';
    else unicode += '\\u00' + str[i].charCodeAt(0).toString(16);
  };
  return unicode;
}



UnicodeTochar = function(str) { 
  
  if (!str) return false;
  var char = str.replace(/ /gi,'\\\\u0020').split('\\\\u00');
  var result = "";
  for ( var i = 1; i< char.length; i++)
  {
    console.log(String.fromCharCode(parseInt(char[i],16)));
    result += String.fromCharCode(parseInt(char[i],16));
  } 
  return result;
}

UnicodeTochar2 = function(str) { 
  
  if (!str) return false;
  var char = str.replace(/ /gi,'\\u0020').split('\\u00');
  var result = "";
  for ( var i = 1; i< char.length; i++)
  {
    console.log(String.fromCharCode(parseInt(char[i],16)));
    result += String.fromCharCode(parseInt(char[i],16));
  } 
  return result;
}


</script>
